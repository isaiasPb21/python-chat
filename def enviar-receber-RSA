# Função Enviar Criptografado

def enviarMensagens():
   
   # Mostrando na tela
   listB.insert(END, 'Eu : '+ mensagem.get())

   # Identifica o nome a ser enviado
   nomeEnvio = '123'
   nomeEnvio += nome.get() # Referencia a uma Entry/tkinter  
   
   ip = '192.168.xx.xx'
   port = 2121
   add = (ip, port)
   
   clientSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
   clientSocket.connect(add)
   
    def cifra(x):
        preCodificadoEnvio = []             # É necessário pré codificar antes de codificar 
        codificadoRsaEnvio = []             # Armazena os objetos pré codificados
        codificadoRsaStringEnvio = []       # Armazena os objetos codificados

        # Pré cifragem
        for i in x:
            aux3 = alfabeto.index(i) * 10
            preCodificadoEnvio.append(aux3)

        # Cifragem
        for i in preCodificadoEnvio:
            aux4 = (i ** chaveE) % chaveN
            codificadoRsaEnvio.append(aux4)

        # Int para String -- Para envio
        for i in codificadoRsaEnvio:
            aux5 = str(i)
            codificadoRsaStringEnvio.append(aux5)  

        # Junta os caracteres em uma string
        codificadoRsaEnvio = '_'.join(codificadoRsaStringEnvio)

    codificadoRsaEnvio = '_'.join(codificadoRsaStringEnvio)    
   
   clientSocket.sendto(codificadoRsaEnvio.encode(), (ip, port))
   mensagem.delete(0, END)
   clientSocket.close()

# Receber Criptografado

def recebeMensagem ():
   
   host = '192.168.11.77'
   port = 2121
   add = (host, port)
   
   serv_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
   serv_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

   serv_socket.bind(add)
   serv_socket.listen(10)   

   while True:
      con, cliente = serv_socket.accept()
      recebe = con.recv(2024)
      recebe = recebe.decode()
      recebe = recebe.split('_')

      def decripto(recebe):
          recebeInt = []
          codificadoRsaRecebimento = []
          preCodificadoRecebimento = []

          # -- Transformando a variavel recebe(c) em Inteiros
          for i in  recebe:
              aux0 = int(i)
              recebeInt.append(aux0)
              print(recebeInt)  #       
  
          # -- Decodificacao
          for i in recebeInt:
              aux1 = (i ** chaveD) % chaveN
              codificadoRsaRecebimento.append(aux1)
              print(codificadoRsaRecebimento)  #              
             
          # -- des pré Codificação
          for i in codificadoRsaRecebimento:
              aux2 = alfabeto[i // 10]
              preCodificadoRecebimento.append(aux2)
              print(preCodificadoRecebimento)   #

          # -- Reajuntando a mensagem
          mensagemOriginal = ''.join(preCodificadoRecebimento)  

